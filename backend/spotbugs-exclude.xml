<?xml version="1.0" encoding="UTF-8"?>
<FindBugsFilter>
    <!-- Exclude Lombok-generated code -->
    <Match>
        <Source name="~.*\.java"/>
        <Bug pattern="EI_EXPOSE_REP"/>
    </Match>
    <Match>
        <Source name="~.*\.java"/>
        <Bug pattern="EI_EXPOSE_REP2"/>
    </Match>

    <!-- Exclude builder pattern false positives -->
    <Match>
        <Class name="~.*\$.*Builder"/>
    </Match>

    <!-- Exclude test classes -->
    <Match>
        <Class name="~.*Test"/>
    </Match>
    <Match>
        <Class name="~.*Tests"/>
    </Match>
    <Match>
        <Package name="~.*\.test\..*"/>
    </Match>

    <!-- Exclude configuration classes -->
    <Match>
        <Class name="~.*Configuration"/>
        <Bug pattern="MS_SHOULD_BE_FINAL"/>
    </Match>

    <!-- Exclude DTO/Entity immutability warnings (Lombok handles this) -->
    <Match>
        <Or>
            <Class name="~.*Dto"/>
            <Class name="~.*Entity"/>
            <Class name="~.*\.domain\.model\..*"/>
        </Or>
        <Or>
            <Bug pattern="EI_EXPOSE_REP"/>
            <Bug pattern="EI_EXPOSE_REP2"/>
        </Or>
    </Match>

    <!-- Exclude Spring injection patterns -->
    <Match>
        <Bug pattern="UWF_FIELD_NOT_INITIALIZED_IN_CONSTRUCTOR"/>
    </Match>

    <!-- Security: CRLF log injection - false positives for file path logging -->
    <!-- File paths from database are logged for debugging, not user input -->
    <Match>
        <Bug pattern="CRLF_INJECTION_LOGS"/>
    </Match>

    <!-- Security: Command injection - paths come from database/config, not user input -->
    <!-- mega-get/mega-ls commands use validated Mega paths stored in database -->
    <Match>
        <Or>
            <Class name="com.mediaserver.service.MegaDownloadService"/>
            <Class name="com.mediaserver.service.MegaScanService"/>
        </Or>
        <Bug pattern="COMMAND_INJECTION"/>
    </Match>
</FindBugsFilter>
